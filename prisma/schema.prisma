// Prisma Schema 文件 - 简化版
// 文档: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// ============================================
// 用户表
// ============================================
model User {
  id          Int      @id @default(autoincrement())
  email       String   @unique
  username    String   @unique
  password    String   // 加密后的密码
  nickname    String?
  avatar      String?  @db.Text  // 头像 URL
  hlzs_user_id Int?     @unique  // 护理之声用户ID
  role        Role     @default(USER)
  status      Status   @default(ACTIVE)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // 关联关系
  notes       Note[]   // 一对多：一个用户可以有多条笔记

  @@map("users")
}

// ============================================
// 笔记表
// ============================================
model Note {
  id        Int        @id @default(autoincrement())
  title     String     @db.VarChar(255)
  content   String     @db.Text
  userId    Int                             // 外键：关联用户
  user      User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  tags      String?    @db.VarChar(500)    // 标签，逗号分隔
  status    NoteStatus @default(DRAFT)     // 状态：草稿/已发布
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt

  @@map("notes")
  @@index([userId])
}

// ============================================
// 用户角色枚举
// ============================================
enum Role {
  ADMIN     // 管理员
  USER      // 普通用户
  GUEST     // 访客
}

// ============================================
// 用户状态枚举
// ============================================
enum Status {
  ACTIVE    // 激活
  INACTIVE  // 停用
  BANNED    // 封禁
}

// ============================================
// 笔记状态枚举
// ============================================
enum NoteStatus {
  DRAFT      // 草稿
  PUBLISHED  // 已发布
  ARCHIVED   // 已归档
}
